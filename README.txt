
# 华夏离线批量编辑器（精确模板版）

**联行号导入（离线）**：
- CNAPS（大额支付行号）导入：TXT/XLS，列顺序固定为 `BNKCODE, CLSCODE, CITYCODE, LNAME`
  - 系统入库：`code=BNKCODE`，`name=LNAME`
- IBPS（跨行清算行号）导入：TXT/XLS，两列：`清算行行号, 清算行名称`
  - 系统入库：`code=清算行行号`，`name=清算行名称`

**代发工资模板（仅 IBPS 参考，不写入行号列）**
- 4 列（文本）：`收款人银行名称, 收款人卡号, 收款人名称, 金额`
- 校验：银行名称/姓名非空；卡号 6-32 位数字；金额>0（但导出仍为**文本**）
- 导出：所有单元格强制 `text` 格式（避免 Excel 自动转数值/科学计数）

**批量转账模板**
- 9 列（文本）：`收款方账号, 收款方户名, 金额, 转账方式(0行内/1跨行), 行别信息类型(0清算/1支行), 收款方银行名称, 收款方银行大额支付行号/跨行清算行号, 用途, 明细标注`
- 选择填充来源：`IBPS` 或 `CNAPS`（根据“收款方银行名称”模糊匹配入库名称，写入“行号”列）
- 校验要点：
  - 户名非空、账号 6-32 位数字、金额>0
  - 当 `转账方式=1(跨行)` 时，**必须**提供“收款方银行大额支付行号/跨行清算行号”

## 使用
1. `pip install -r requirements.txt`（如需读取 `.xls`：`pip install xlrd`）
2. `python app_exact.py`
3. **先进入“库维护”**：导入 IBPS/CNAPS 本地文件（TXT 或 XLS），可选择全量替换或按 code 合并
4. 再进入“代发工资”或“批量转账”加载你的业务文件，规范列序、按需填充、校验与导出（全部文本格式）
